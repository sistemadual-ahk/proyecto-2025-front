<div class="modal-overlay" (click)="onClose()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <button class="icon-btn" (click)="onClose()"><i class="mdi mdi-close"></i></button>
      <div class="modal-title"><i class="mdi mdi-target"></i><span>{{ edit ? 'Editar objetivo' : 'Nuevo Objetivo' }}</span></div>
      <div class="header-actions">
        <button class="icon-btn danger" *ngIf="edit" (click)="onDelete()"><i class="mdi mdi-delete"></i></button>
        <button class="icon-btn" (click)="onSave()"><i class="mdi mdi-check"></i></button>
      </div>
    </div>

    <div class="form">
      <div class="field pill">
        <span class="prefix">$</span>
        <input type="number" placeholder="0.0" [(ngModel)]="amount" />
        <button class="suffix"><i class="mdi mdi-close"></i></button>
      </div>

      <div class="field select">
        <span class="label">Categoría</span>
        <div class="right">
          <span class="color" [style.background]="color"></span>
          <i class="mdi mdi-chevron-down"></i>
        </div>
      </div>

      <div class="row">
        <div class="field date">
          <span>Fecha Inicio</span>
          <i class="mdi mdi-calendar"></i>
        </div>
        <div class="field date" [class.disabled]="edit">
          <span>Fecha fin</span>
          <i class="mdi mdi-calendar"></i>
        </div>
      </div>

      <div class="field input">
        <span>Titulo</span>
      </div>

      <!-- Estado del objetivo -->
      <div class="field status-field">
        <div class="status-section">
          <span class="status-label">Estado del objetivo</span>
          <div class="status-control">
            <label class="switch">
              <input 
                type="checkbox" 
                [checked]="isCompleted()"
                (change)="toggleEstado()"
              />
              <span class="slider"></span>
            </label>
            <span class="status-text">{{ getStatusLabel() }}</span>
          </div>
        </div>
      </div>

      <!-- Lista de operaciones asociadas -->
      <div class="field operations-field" *ngIf="edit">
        <div class="operations-section">
          <div class="operations-header">
            <i class="mdi mdi-cash-multiple"></i>
            <span class="operations-label">Operaciones asociadas</span>
            <span class="operations-count">{{ operaciones.length }}</span>
          </div>
          
          <div class="operations-list" *ngIf="operaciones.length > 0">
            <div class="operation-item" *ngFor="let op of operaciones">
              <div class="operation-icon" [class.income]="op.tipo === 'Ingreso' || op.tipo === 'income'">
                <i class="mdi" [ngClass]="op.tipo === 'Ingreso' || op.tipo === 'income' ? 'mdi-arrow-up' : 'mdi-arrow-down'"></i>
              </div>
              <div class="operation-info">
                <span class="operation-desc">{{ op.descripcion || 'Sin descripción' }}</span>
                <span class="operation-date">{{ op.fecha | date: 'dd/MM/yyyy' }}</span>
              </div>
              <span class="operation-amount" [class.income]="op.tipo === 'Ingreso' || op.tipo === 'income'">
                {{ (op.tipo === 'Ingreso' || op.tipo === 'income' ? '+' : '-') }}${{ op.monto.toLocaleString() }}
              </span>
            </div>
          </div>
          
          <div class="operations-empty" *ngIf="operaciones.length === 0">
            <i class="mdi mdi-information-outline"></i>
            <span>No hay operaciones asociadas a este objetivo</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


