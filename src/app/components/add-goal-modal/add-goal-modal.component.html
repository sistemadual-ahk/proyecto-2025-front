<div class="modal-content-wrapper">
<!-- Header del bottom sheet -->
<div class="bottom-sheet-header">
  <button class="close-btn" (click)="onClose()">
    <i class="mdi mdi-close"></i>
  </button>

  <h2 class="bottom-sheet-title">
    <i class="mdi mdi-piggy-bank"></i>
    {{ edit ? 'Editar Objetivo' : 'Nuevo Objetivo' }}
  </h2>

  <button
    class="save-btn"
    type="button"
    (click)="onSave()"
    [disabled]="!isFormValid"
    [class.enabled]="isFormValid"
  >
    <i class="mdi mdi-check"></i>
  </button>
</div>

<!-- Formulario -->
<div class="transaction-form">
  <!-- Título -->
  <div class="form-group">
    <label class="form-label">Título</label>
    <input 
      type="text" 
      class="form-input" 
      placeholder="Ej: Viaje a Brasil" 
      [(ngModel)]="titulo" 
    />
  </div>

  <!-- Monto Objetivo -->
  <div class="form-group amount-group">
    <label class="form-label">Monto Objetivo</label>
    <input 
      type="number" 
      inputmode="numeric"
      class="form-input" 
      placeholder="0" 
      [(ngModel)]="montoObjetivo"
      min="0"
      step="0.01"
    />
  </div>

  <!-- Monto Actual (solo en edición) -->
  <div class="form-group" *ngIf="edit">
    <label class="form-label">Monto Actual</label>
    <input 
      type="number" 
      inputmode="numeric"
      class="form-input" 
      placeholder="0" 
      [(ngModel)]="montoActual" 
      readonly 
      style="background: rgba(255, 255, 255, 0.05); cursor: not-allowed;"
    />
  </div>

  <!-- Categoría -->
  <div class="form-group">
    <label class="form-label">Categoría (opcional)</label>
    <mat-select
      class="form-input"
      [(ngModel)]="categoriaId"
      placeholder="Sin categoría"
    >
      <mat-select-trigger>
        <div class="category-option-row" *ngIf="getSelectedCategory() as selectedCat">
          <div class="category-icon-preview" [style.background-color]="selectedCat.color">
            <i class="mdi" [ngClass]="selectedCat.icono" [style.color]="selectedCat.iconColor || '#fff'"></i>
          </div>
          <span class="category-name">{{ selectedCat.nombre }}</span>
        </div>
        <span *ngIf="!getSelectedCategory()">Sin categoría</span>
      </mat-select-trigger>
      <mat-option value="">Sin categoría</mat-option>
      <mat-option *ngFor="let categoria of categorias" [value]="categoria.id">
        <div class="category-option-row">
          <div class="category-icon-preview" [style.background-color]="categoria.color">
            <i class="mdi" [ngClass]="categoria.icono" [style.color]="categoria.iconColor || '#fff'"></i>
          </div>
          <span class="category-name">{{ categoria.nombre }}</span>
        </div>
      </mat-option>
    </mat-select>
  </div>

  <!-- Fechas -->
  <div class="form-row">
    <div class="form-group">
      <label class="form-label">Fecha Inicio</label>
      <div class="input-with-icon">
        <input 
          type="date" 
          class="form-input" 
          [(ngModel)]="fechaInicio" 
        />
        <i class="mdi mdi-calendar"></i>
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">Fecha Esperada</label>
      <div class="input-with-icon">
        <input 
          type="date" 
          class="form-input" 
          [(ngModel)]="fechaEsperadaFinalizacion" 
        />
        <i class="mdi mdi-calendar"></i>
      </div>
    </div>
  </div>

  <!-- Fecha de finalización (solo si está completado) -->
  <div class="form-group" *ngIf="isCompleted()">
    <label class="form-label">Fecha de Finalización</label>
    <div class="input-with-icon">
      <input 
        type="date" 
        class="form-input" 
        [(ngModel)]="fechaFin" 
      />
      <i class="mdi mdi-calendar"></i>
    </div>
  </div>

  <!-- Estado del objetivo (solo en edición) -->
  <div class="form-group status-field" *ngIf="edit">
    <label class="form-label">Estado del objetivo</label>
    <div class="status-controls">
      <span class="status-text" [class.completed]="isCompleted()">
        {{ isCompleted() ? '✓ Completado' : 'Pendiente' }}
      </span>
      <label class="switch">
        <input 
          type="checkbox" 
          [checked]="isCompleted()" 
          (change)="toggleEstado()"
        />
        <span class="slider"></span>
      </label>
    </div>
  </div>

  <!-- Botón de eliminar (solo en edición) -->
  <button 
    *ngIf="edit" 
    type="button" 
    class="delete-btn-bottom" 
    (click)="onDelete()">
    <i class="mdi mdi-delete"></i>
    Eliminar Objetivo
  </button>
</div>
</div>
